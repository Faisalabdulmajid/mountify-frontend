"use strict";(self.webpackChunkspk_gunung=self.webpackChunkspk_gunung||[]).push([[146],{8500:(a,e,n)=>{n.r(e),n.d(e,{default:()=>c});var i=n(2555),t=n(5043),s=n(1283),o=n(7488),l=(n(2342),n(579));const r="http://localhost:5000",d=a=>a?a.toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "):"";const c=function(){const a=(0,s.Zp)(),[e,n]=(0,t.useState)({nama_titik:"",tipe_titik:"Pos",id_jalur:"",koordinat:"",deskripsi:"",ketersediaan_air:!1,kapasitas_tenda:0}),[c,u]=(0,t.useState)(""),[h,g]=(0,t.useState)([]),[p,m]=(0,t.useState)([]),[j,k]=(0,t.useState)([]),[x,f]=(0,t.useState)(!1);(0,t.useEffect)(()=>{(async()=>{f(!0);try{const e=localStorage.getItem("token");console.log("\ud83d\udd04 Fetching data for dropdowns...");const[n,i]=await Promise.all([fetch("".concat(r,"/api/gunung"),{headers:{Authorization:"Bearer ".concat(e)}}),fetch("".concat(r,"/api/admin/jalur-for-poi"),{headers:{Authorization:"Bearer ".concat(e)}})]);console.log("\ud83d\udcca Response status - Gunung:",n.status,"Jalur:",i.status);let t=[];if(i.ok)t=await i.json(),console.log("\u2705 Endpoint /api/admin/jalur-for-poi berhasil");else{console.warn("\u26a0\ufe0f Endpoint /api/admin/jalur-for-poi gagal, status:",i.status);const n=await i.text();console.log("\u274c Error response:",n),console.log("\ud83d\udd04 Mencoba endpoint standar admin jalur...");try{const a=await fetch("".concat(r,"/api/admin/jalur"),{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok)t=await a.json(),console.log("\u2705 Berhasil menggunakan endpoint standar /api/admin/jalur");else{console.log("\ud83d\udd04 Mencoba endpoint alternatif /api/jalur...");const a=await fetch("".concat(r,"/api/jalur"),{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok)t=await a.json(),console.log("\u2705 Berhasil menggunakan endpoint alternatif /api/jalur");else{const e=await a.text();console.error("\u274c Endpoint alternatif juga gagal:",a.status,e)}}}catch(a){console.error("\u274c Endpoint alternatif juga gagal:",a)}}if(!n.ok&&0===t.length)throw new Error("Gagal memuat data untuk dropdown.");const s=await n.json();if(console.log("\ud83d\udcc8 Data loaded:"),console.log("- Gunung:",s),console.log("- Jalur:",t),t.length>0){const a=t[0];console.log("\ud83d\udd0d Sample jalur structure:",a),a.hasOwnProperty("id_gunung")||console.warn("\u26a0\ufe0f Data jalur tidak memiliki field id_gunung!")}g(s),m(t)}catch(e){console.error("\u274c Error fetching dropdown data:",e),o.oR.error(e.message)}finally{f(!1)}})()},[]),(0,t.useEffect)(()=>{if(console.log("\ud83d\udd0d Debug Filter Jalur:"),console.log("- idGunung:",c,"type:",typeof c),console.log("- jalurList:",p),c){const a=p.filter(a=>{const e=a.id_gunung===parseInt(c),n=String(a.id_gunung)===String(c),i=a.id_gunung==c;return console.log('- Jalur "'.concat(a.nama_jalur,'": id_gunung=').concat(a.id_gunung," (").concat(typeof a.id_gunung,"), match=").concat(e||n||i)),e||n||i});console.log("- Jalur tersedia:",a),k(a)}else k([]);n(a=>(0,i.A)((0,i.A)({},a),{},{id_jalur:""}))},[c,p]);const _=a=>{const{name:e,value:t,type:s,checked:o}=a.target;n(a=>(0,i.A)((0,i.A)({},a),{},{[e]:"checkbox"===s?o:t}))};return(0,l.jsxs)("div",{className:"add-poi-page",children:[(0,l.jsx)(o.N9,{position:"top-right",autoClose:3e3}),(0,l.jsxs)("header",{className:"page-header",children:[(0,l.jsx)("h1",{children:"Tambah Titik Penting (POI) Baru"}),(0,l.jsxs)(s.N_,{to:"/admin/poi",className:"btn-back",children:[(0,l.jsx)("i",{className:"bi bi-arrow-left"})," Kembali ke Daftar POI"]})]}),(0,l.jsxs)("form",{onSubmit:async n=>{if(n.preventDefault(),!e.nama_titik||!e.id_jalur)return void o.oR.warn("Nama POI dan Jalur terkait wajib diisi.");f(!0);const t=(0,i.A)((0,i.A)({},e),{},{nama_titik:d(e.nama_titik)});try{const e=localStorage.getItem("token"),n=await fetch("".concat(r,"/api/admin/poi"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(t)}),i=await n.json();if(!n.ok)throw new Error(i.message);o.oR.success(i.message),a("/admin/poi")}catch(s){o.oR.error(s.message||"Terjadi kesalahan.")}finally{f(!1)}},className:"form-widget-poi",children:[(0,l.jsxs)("fieldset",{className:"form-fieldset",disabled:x,children:[(0,l.jsx)("legend",{children:"Informasi Utama"}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"nama_titik",children:"Nama Titik Penting (POI)"}),(0,l.jsx)("input",{type:"text",id:"nama_titik",name:"nama_titik",value:e.nama_titik,onChange:_,onBlur:a=>{const{name:e,value:t}=a.target;"nama_titik"===e&&n(a=>(0,i.A)((0,i.A)({},a),{},{[e]:d(t)}))},required:!0,placeholder:"Contoh: Pos 3 Kandang Badak"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"tipe_titik",children:"Kategori Titik Penting"}),(0,l.jsxs)("select",{id:"tipe_titik",name:"tipe_titik",value:e.tipe_titik,onChange:_,children:[(0,l.jsx)("option",{value:"Pos",children:"Pos"}),(0,l.jsx)("option",{value:"Shelter",children:"Shelter"}),(0,l.jsx)("option",{value:"Sumber Air",children:"Sumber Air"}),(0,l.jsx)("option",{value:"Area Kemah",children:"Area Kemah"}),(0,l.jsx)("option",{value:"Puncak",children:"Puncak"}),(0,l.jsx)("option",{value:"Spot Foto",children:"Spot Foto"}),(0,l.jsx)("option",{value:"Persimpangan",children:"Persimpangan"}),(0,l.jsx)("option",{value:"Lainnya",children:"Lainnya"})]})]})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"id_gunung",children:"Terletak di Gunung"}),(0,l.jsxs)("select",{id:"id_gunung",name:"id_gunung",value:c,onChange:a=>{u(a.target.value)},children:[(0,l.jsx)("option",{value:"",children:"-- Pilih Gunung untuk filter jalur --"}),h.map(a=>(0,l.jsx)("option",{value:a.id_gunung,children:a.nama_gunung},a.id_gunung))]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"id_jalur",children:"Berada di Jalur"}),!1,(0,l.jsxs)("select",{id:"id_jalur",name:"id_jalur",value:e.id_jalur,onChange:_,required:!0,disabled:!c||0===j.length,children:[(0,l.jsx)("option",{value:"",children:c?0===j.length?"-- Tidak ada jalur tersedia --":"-- Pilih Jalur --":"-- Pilih Gunung dulu --"}),j.map(a=>(0,l.jsx)("option",{value:a.id_jalur,children:a.nama_jalur},a.id_jalur))]})]})]}),(0,l.jsxs)("div",{className:"form-group full-width",children:[(0,l.jsx)("label",{htmlFor:"koordinat",children:"Koordinat Lokasi (Latitude, Longitude)"}),(0,l.jsx)("input",{type:"text",id:"koordinat",name:"koordinat",value:e.koordinat,onChange:_,placeholder:"Contoh: -6.7821, 106.9875"})]})]}),(0,l.jsxs)("fieldset",{className:"form-fieldset",disabled:x,children:[(0,l.jsx)("legend",{children:"Atribut Tambahan"}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"kapasitas_tenda",children:"Kapasitas Tenda (jika Area Camp)"}),(0,l.jsx)("input",{type:"number",id:"kapasitas_tenda",name:"kapasitas_tenda",value:e.kapasitas_tenda,onChange:_,placeholder:"0"})]}),(0,l.jsxs)("div",{className:"form-group toggle-group",children:[(0,l.jsx)("label",{children:"Ketersediaan Sumber Air"}),(0,l.jsxs)("div",{className:"toggle-switch-container",children:[(0,l.jsx)("span",{children:"Tidak"}),(0,l.jsxs)("label",{className:"toggle-switch",children:[(0,l.jsx)("input",{type:"checkbox",name:"ketersediaan_air",checked:e.ketersediaan_air,onChange:_}),(0,l.jsx)("span",{className:"slider round"})]}),(0,l.jsx)("span",{children:"Ya"})]})]})]}),(0,l.jsxs)("div",{className:"form-group full-width",children:[(0,l.jsx)("label",{htmlFor:"deskripsi",children:"Deskripsi atau Keterangan Tambahan"}),(0,l.jsx)("textarea",{id:"deskripsi",name:"deskripsi",rows:"4",value:e.deskripsi,onChange:_,placeholder:"Jelaskan hal penting tentang lokasi ini..."})]})]}),(0,l.jsxs)("div",{className:"form-actions",children:[(0,l.jsx)("button",{type:"button",className:"btn-cancel",onClick:()=>a("/admin/poi"),disabled:x,children:"Batal"}),(0,l.jsx)("button",{type:"submit",className:"btn-save",disabled:x,children:x?"Menyimpan...":"Simpan POI"})]})]})]})}}}]);
//# sourceMappingURL=146.1a638e29.chunk.js.map