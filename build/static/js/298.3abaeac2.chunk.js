"use strict";(self.webpackChunkspk_gunung=self.webpackChunkspk_gunung||[]).push([[298],{698:(a,e,n)=>{n.d(e,{A:()=>i});n(5043);var s=n(579);const i=a=>{let{title:e,onAddClick:n,addLabel:i="Tambah",addIcon:l=(0,s.jsx)("i",{className:"bi bi-plus-lg"}),children:t}=a;return(0,s.jsxs)("div",{className:"controls-container",children:[(0,s.jsxs)("div",{className:"header-row",children:[(0,s.jsx)("h1",{className:"page-title",children:e}),n&&(0,s.jsxs)("button",{className:"btn-add-new",onClick:n,children:[l," ",i]})]}),t]})}},2062:(a,e,n)=>{n.d(e,{A:()=>i});n(5043);var s=n(579);const i=a=>{let{currentPage:e,totalPages:n,itemsPerPage:i,totalItems:l,onPageChange:t,onItemsPerPageChange:c,indexOfFirstItem:r,currentItemsLength:d}=a;const o=a=>{a>0&&a<=n&&t(a)};return(0,s.jsxs)("div",{className:"pagination",children:[(0,s.jsxs)("div",{className:"pagination-info",children:[(0,s.jsx)("span",{children:"Baris per halaman:"}),(0,s.jsxs)("select",{value:i,onChange:a=>{c(parseInt(a.target.value,10))},className:"items-per-page-select",children:[(0,s.jsx)("option",{value:5,children:"5"}),(0,s.jsx)("option",{value:10,children:"10"}),(0,s.jsx)("option",{value:20,children:"20"}),(0,s.jsx)("option",{value:50,children:"50"}),(0,s.jsx)("option",{value:100,children:"100"})]}),(0,s.jsxs)("span",{style:{marginLeft:"15px"},children:["Menampilkan ",d>0?r+1:0,"-",r+d," dari ",l," data"]})]}),(0,s.jsxs)("div",{className:"pagination-controls",children:[(0,s.jsx)("button",{onClick:()=>o(e-1),disabled:1===e,children:"Sebelumnya"}),(0,s.jsxs)("span",{children:["Halaman ",e," dari ",n||1]}),(0,s.jsx)("button",{onClick:()=>o(e+1),disabled:e===n||0===n,children:"Selanjutnya"})]})]})}},6681:()=>{},9298:(a,e,n)=>{n.r(e),n.d(e,{default:()=>x});var s=n(5043),i=n(1283),l=n(7488),t=(n(2342),n(64)),c=n.n(t),r=(n(6681),n(698)),d=n(2062),o=n(579);const u=a=>{let{gunungList:e,onDelete:n,onSort:s,sortConfig:l,indexOfFirstItem:t,onViewDetails:c,apiBaseUrl:r,deletingIds:d=new Set}=a;const u=(0,i.Zp)(),h=a=>{if(!a)return"-";const e=a.split("; ");return e.length<=2?a:"".concat(e.slice(0,2).join("; "),"...")},g=a=>void 0===a||null===a?"-":a<=3?"Jalur Tunggal":a<=7?"Beberapa Jalur":a>7?"Banyak Jalur":"-",m=a=>l.key!==a?null:"ascending"===l.direction?(0,o.jsx)("i",{className:"bi bi-sort-up-alt sort-icon-active"}):(0,o.jsx)("i",{className:"bi bi-sort-down sort-icon-active"});return(0,o.jsx)("div",{className:"table-container",children:(0,o.jsxs)("table",{className:"data-table",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:{width:"6%"},children:"No"}),(0,o.jsx)("th",{style:{width:"18%"},onClick:()=>s("nama_gunung"),children:(0,o.jsxs)("div",{className:"header-cell-content",children:[(0,o.jsx)("span",{children:"Nama Gunung"}),m("nama_gunung")]})}),(0,o.jsx)("th",{style:{width:"16%"},className:"col-lokasi",onClick:()=>s("lokasi_administratif"),children:(0,o.jsxs)("div",{className:"header-cell-content",children:[(0,o.jsx)("span",{children:"Lokasi"}),m("lokasi_administratif")]})}),(0,o.jsx)("th",{style:{width:"10%"},className:"col-ketinggian",onClick:()=>s("ketinggian_puncak_mdpl"),children:(0,o.jsxs)("div",{className:"header-cell-content",children:[(0,o.jsx)("span",{children:"Ketinggian"}),m("ketinggian_puncak_mdpl")]})}),(0,o.jsx)("th",{style:{width:"10%"},className:"col-jalur",onClick:()=>s("jumlah_jalur"),children:(0,o.jsxs)("div",{className:"header-cell-content",children:[(0,o.jsx)("span",{children:"Jalur"}),m("jumlah_jalur")]})}),(0,o.jsx)("th",{style:{width:"9%"},className:"col-rating",onClick:()=>s("rating_rata_rata"),children:(0,o.jsxs)("div",{className:"header-cell-content",children:[(0,o.jsx)("span",{children:"Rating"}),m("rating_rata_rata")]})}),(0,o.jsx)("th",{style:{width:"8%"},className:"col-ulasan",onClick:()=>s("jumlah_ulasan"),children:(0,o.jsxs)("div",{className:"header-cell-content",children:[(0,o.jsx)("span",{children:"Ulasan"}),m("jumlah_ulasan")]})}),(0,o.jsx)("th",{style:{width:"23%"},children:"Aksi"})]})}),(0,o.jsx)("tbody",{children:e.length>0?e.map((a,e)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:t+e+1}),(0,o.jsx)("td",{children:(0,o.jsx)("span",{title:a.nama_gunung,children:a.nama_gunung})}),(0,o.jsx)("td",{className:"col-lokasi",children:(0,o.jsx)("span",{title:a.lokasi_administratif||"Lokasi tidak diketahui",style:{fontSize:"0.9em",color:"#64748b"},children:h(a.lokasi_administratif)})}),(0,o.jsx)("td",{className:"col-ketinggian",children:(0,o.jsxs)("span",{title:"Ketinggian: ".concat(a.ketinggian_puncak_mdpl," MDPL"),children:[a.ketinggian_puncak_mdpl," MDPL"]})}),(0,o.jsx)("td",{className:"col-jalur",children:(0,o.jsx)("span",{title:"Variasi Jalur: ".concat(g(a.jumlah_jalur)),children:g(a.jumlah_jalur)})}),(0,o.jsx)("td",{className:"col-rating",children:(0,o.jsxs)("span",{title:"Rating rata-rata: ".concat(parseFloat(a.rating_rata_rata).toFixed(1)),children:[(0,o.jsx)("i",{className:"bi bi-star-fill",style:{color:"#fbbf24",marginRight:"4px"}}),parseFloat(a.rating_rata_rata).toFixed(1)]})}),(0,o.jsx)("td",{className:"col-ulasan",children:(0,o.jsxs)("span",{title:"Total ".concat(a.jumlah_ulasan," ulasan"),children:[a.jumlah_ulasan," ulasan"]})}),(0,o.jsx)("td",{className:"col-aksi",style:{textAlign:"center",verticalAlign:"middle"},children:(0,o.jsxs)("div",{className:"action-buttons",children:[(0,o.jsx)("button",{className:"action-btn btn-view-details",title:"Detail Cepat",onClick:()=>c(a),children:(0,o.jsx)("i",{className:"bi bi-eye-fill"})}),(0,o.jsx)("button",{className:"action-btn btn-view-paths",title:"Lihat Jalur",onClick:()=>u("/admin/jalur?gunungId=".concat(a.id_gunung)),children:(0,o.jsx)("i",{className:"bi bi-signpost-split-fill"})}),(0,o.jsx)("button",{className:"action-btn btn-edit",title:"Edit Gunung",onClick:()=>u("/admin/gunung/edit/".concat(a.id_gunung)),children:(0,o.jsx)("i",{className:"bi bi-pencil-fill"})}),(0,o.jsx)("button",{className:"action-btn btn-delete",title:"Hapus Gunung",onClick:()=>n(a.id_gunung),disabled:d.has(a.id_gunung),children:d.has(a.id_gunung)?(0,o.jsx)("i",{className:"bi bi-arrow-repeat",style:{animation:"spin 1s linear infinite"}}):(0,o.jsx)("i",{className:"bi bi-trash-fill"})})]})})]},a.id_gunung)):(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:"8",style:{textAlign:"center",padding:"20px"},children:"Tidak ada data gunung yang cocok dengan filter."})})})]})})};var h=n(2555);const g=a=>{let{searchTerm:e,onSearchChange:n,jalurFilter:s,onFilterChange:i,filterKetinggian:l,onKetinggianFilterChange:t}=a;const c=a=>{const{name:e,value:n}=a.target;t(a=>(0,h.A)((0,h.A)({},a),{},{[e]:n}))};return(0,o.jsxs)("div",{className:"toolbar",children:[(0,o.jsx)("div",{className:"search-container",children:(0,o.jsxs)("div",{className:"input-wrapper-icon",children:[(0,o.jsx)("i",{className:"bi bi-search"}),(0,o.jsx)("input",{type:"text",placeholder:"Cari berdasarkan nama gunung atau lokasi...",value:e,onChange:a=>n(a.target.value)})]})}),(0,o.jsxs)("div",{className:"filter-container",children:[(0,o.jsxs)("div",{className:"filter-group",children:[(0,o.jsx)("label",{children:"Jalur:"}),(0,o.jsxs)("select",{value:s,onChange:a=>i(a.target.value),children:[(0,o.jsx)("option",{value:"Semua",children:"Semua"}),(0,o.jsx)("option",{value:"Punya Jalur",children:"Punya Jalur"}),(0,o.jsx)("option",{value:"Belum Ada Jalur",children:"Belum Ada Jalur"})]})]}),(0,o.jsxs)("div",{className:"filter-group ketinggian-group",children:[(0,o.jsx)("label",{children:"Ketinggian (mdpl):"}),(0,o.jsxs)("div",{className:"ketinggian-inputs",children:[(0,o.jsx)("input",{type:"number",name:"min",placeholder:"Min",value:l.min,onChange:c,className:"ketinggian-input"}),(0,o.jsx)("span",{className:"separator",children:"-"}),(0,o.jsx)("input",{type:"number",name:"max",placeholder:"Maks",value:l.max,onChange:c,className:"ketinggian-input"})]})]})]})]})},m=a=>{let{gunung:e,onClose:n}=a;if(!e)return null;return(0,o.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,o.jsxs)("div",{className:"modal-content",onClick:a=>a.stopPropagation(),children:[(0,o.jsxs)("div",{className:"modal-header",children:[(0,o.jsx)("h2",{children:e.nama_gunung}),(0,o.jsx)("button",{onClick:n,className:"modal-close-btn",children:"\xd7"})]}),(0,o.jsxs)("div",{className:"modal-body",children:[e.url_thumbnail&&(0,o.jsx)("img",{src:"".concat("http://localhost:5000").concat(e.url_thumbnail),alt:e.nama_gunung,className:"modal-thumbnail"}),(0,o.jsxs)("div",{className:"modal-details",children:[(0,o.jsxs)("div",{className:"detail-item",children:[(0,o.jsx)("span",{className:"detail-label",children:"Ketinggian"}),(0,o.jsxs)("span",{className:"detail-value",children:[e.ketinggian_puncak_mdpl," MDPL"]})]}),(0,o.jsxs)("div",{className:"detail-item",children:[(0,o.jsx)("span",{className:"detail-label",children:"Variasi Jalur"}),(0,o.jsx)("span",{className:"detail-value",children:(s=e.variasi_jalur_skala,s>=0&&s<=3?"Jalur Tunggal":s>=4&&s<=7?"Beberapa Jalur":s>=8&&s<=10?"Banyak Jalur":"Belum diisi")})]}),(0,o.jsxs)("div",{className:"detail-item",children:[(0,o.jsx)("span",{className:"detail-label",children:"Lokasi"}),(0,o.jsx)("div",{className:"detail-value",children:(()=>{const a=(a=>{if(!a)return"Lokasi tidak diketahui";const e=a.split("; ");return 1===e.length?a:e})(e.lokasi_administratif);return Array.isArray(a)?(0,o.jsx)("div",{className:"location-list",children:a.map((a,e)=>(0,o.jsxs)("span",{className:"location-item",children:[(0,o.jsx)("i",{className:"bi bi-geo-alt-fill",style:{marginRight:"4px",color:"#0369a1"}}),a]},e))}):(0,o.jsxs)("span",{children:[(0,o.jsx)("i",{className:"bi bi-geo-alt-fill",style:{marginRight:"4px",color:"#0369a1"}}),a]})})()})]}),(0,o.jsxs)("div",{className:"detail-item",children:[(0,o.jsx)("span",{className:"detail-label",children:"Jumlah Jalur"}),(0,o.jsxs)("span",{className:"detail-value",children:[e.jumlah_jalur," Jalur"]})]}),(0,o.jsxs)("div",{className:"detail-item",children:[(0,o.jsx)("span",{className:"detail-label",children:"Rating"}),(0,o.jsxs)("span",{className:"detail-value rating-value",children:[(0,o.jsx)("i",{className:"bi bi-star-fill"}),parseFloat(e.rating_rata_rata).toFixed(1),(0,o.jsxs)("span",{className:"ulasan-count",children:["(",e.jumlah_ulasan," ulasan)"]})]})]})]}),(0,o.jsxs)("div",{className:"modal-deskripsi",children:[(0,o.jsx)("strong",{children:"Deskripsi Singkat"}),(0,o.jsx)("p",{children:e.deskripsi_singkat||"Tidak ada deskripsi."})]})]})]})});var s},j="http://localhost:5000";const x=function(){const a=(0,i.Zp)(),[e,n]=(0,s.useState)([]),[t,h]=(0,s.useState)(!0),[x,p]=(0,s.useState)(null),[k,N]=(0,s.useState)(""),[b,v]=(0,s.useState)("Semua"),[f,_]=(0,s.useState)({min:"",max:""}),[C,y]=(0,s.useState)(!1),[w,S]=(0,s.useState)(null),[P,A]=(0,s.useState)({key:"id_gunung",direction:"descending"}),[B,J]=(0,s.useState)(1),[L,I]=(0,s.useState)(5),[F,T]=(0,s.useState)(new Set),[D,E]=(0,s.useState)(""),R=((a,e)=>{const[n,i]=(0,s.useState)(a);return(0,s.useEffect)(()=>{const n=setTimeout(()=>{i(a)},e);return()=>{clearTimeout(n)}},[a,e]),n})(k,300);(0,s.useEffect)(()=>{(async()=>{try{const a=await fetch("".concat(j,"/api/csrf-token"),{credentials:"include"});if(a.ok){const e=await a.json();E(e.csrfToken)}}catch(a){}})()},[]);const M=(0,s.useCallback)(async()=>{try{const a=localStorage.getItem("token"),e=await fetch("".concat(j,"/api/admin/gunung"),{headers:{Authorization:"Bearer ".concat(a),"X-CSRF-Token":D},credentials:"include"});if(!e.ok){const a=await e.json().catch(()=>({message:"Gagal mengambil data gunung."}));throw new Error(a.message)}const s=await e.json();n(s)}catch(x){p(x.message),l.oR.error(x.message)}finally{h(!1)}},[D]);(0,s.useEffect)(()=>{M()},[M]),(0,s.useEffect)(()=>{J(1)},[L,R,b,f]);const K=(0,s.useMemo)(()=>{let a=[...e];return"Punya Jalur"===b?a=a.filter(a=>a.jumlah_jalur>0):"Belum Ada Jalur"===b&&(a=a.filter(a=>0===a.jumlah_jalur)),(f.min||f.max)&&(a=a.filter(a=>{const e=f.min?parseInt(f.min,10):0,n=f.max?parseInt(f.max,10):1/0;return a.ketinggian_puncak_mdpl>=e&&a.ketinggian_puncak_mdpl<=n})),R&&(a=a.filter(a=>a.nama_gunung.toLowerCase().includes(R.toLowerCase())||a.lokasi_administratif&&a.lokasi_administratif.toLowerCase().includes(R.toLowerCase()))),null!==P.key&&a.sort((a,e)=>{const n=a[P.key],s=e[P.key];return n<s?"ascending"===P.direction?-1:1:n>s?"ascending"===P.direction?1:-1:0}),a},[e,R,P,b,f]),G=B*L,O=G-L,V=K.slice(O,G),z=Math.ceil(K.length/L);return t?(0,o.jsx)("div",{className:"loading-container",children:"Memuat data..."}):x&&0===e.length?(0,o.jsxs)("div",{className:"form-error-message",style:{margin:"20px"},children:["Error: ",x]}):(0,o.jsxs)("div",{className:"gunung-management-page",children:[(0,o.jsx)(l.N9,{position:"top-right",autoClose:3e3,hideProgressBar:!1}),C&&(0,o.jsx)(m,{gunung:w,onClose:()=>y(!1)}),(0,o.jsx)(r.A,{title:"Manajemen Data Gunung",addLabel:"Tambah Gunung",onAddClick:()=>a("/admin/gunung/new")}),(0,o.jsx)(g,{searchTerm:k,onSearchChange:N,jalurFilter:b,onFilterChange:v,filterKetinggian:f,onKetinggianFilterChange:_}),(0,o.jsx)(u,{gunungList:V,onDelete:async a=>{if((await c().fire({title:"Anda Yakin?",text:"Data tidak dapat dikembalikan.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed){T(e=>new Set([...e,a]));try{const e=localStorage.getItem("token"),s=await fetch("".concat(j,"/api/admin/gunung/").concat(a),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e),"X-CSRF-Token":D},credentials:"include"});if(!s.ok){const a=await s.json();throw new Error(a.message||"Gagal menghapus data.")}l.oR.success("Data gunung berhasil dihapus."),n(e=>e.filter(e=>e.id_gunung!==a))}catch(x){l.oR.error(x.message)}finally{T(e=>{const n=new Set(e);return n.delete(a),n})}}},onSort:a=>{let e="ascending";P.key===a&&"ascending"===P.direction&&(e="descending"),A({key:a,direction:e})},sortConfig:P,indexOfFirstItem:O,onViewDetails:a=>{S(a),y(!0)},apiBaseUrl:j,deletingIds:F}),(0,o.jsx)(d.A,{currentPage:B,totalPages:z,itemsPerPage:L,totalItems:K.length,onPageChange:a=>J(a),onItemsPerPageChange:a=>{I(a),J(1)},indexOfFirstItem:O,currentItemsLength:V.length})]})}}}]);
//# sourceMappingURL=298.3abaeac2.chunk.js.map