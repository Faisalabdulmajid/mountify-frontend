"use strict";(self.webpackChunkspk_gunung=self.webpackChunkspk_gunung||[]).push([[33],{505:(a,e,i)=>{i.r(e),i.d(e,{default:()=>c});var t=i(2555),n=i(5043),s=i(1283),r=i(7488),l=(i(2342),i(579));const o="http://localhost:5000",d=a=>a?a.toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "):"";const c=function(){const a=(0,s.Zp)(),{id_poi:e}=(0,s.g)(),[i,c]=(0,n.useState)({nama_titik:"",tipe_titik:"",id_jalur:"",koordinat:"",deskripsi:"",ketersediaan_air:!1,kapasitas_tenda:0}),[u,m]=(0,n.useState)(""),[h,p]=(0,n.useState)([]),[j,g]=(0,n.useState)([]),[k,x]=(0,n.useState)([]),[_,f]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{f(!0);try{const a=localStorage.getItem("token"),[i,t,n]=await Promise.all([fetch("".concat(o,"/api/gunung"),{headers:{Authorization:"Bearer ".concat(a)}}),fetch("".concat(o,"/api/admin/jalur"),{headers:{Authorization:"Bearer ".concat(a)}}),fetch("".concat(o,"/api/admin/poi/").concat(e),{headers:{Authorization:"Bearer ".concat(a)}})]);if(!i.ok||!t.ok||!n.ok)throw new Error("Gagal memuat data esensial.");const s=await i.json(),r=await t.json(),l=await n.json();p(s),g(r);const d=r.find(a=>a.id_jalur===l.id_jalur);d&&m(d.id_gunung),c({nama_titik:l.nama_titik||"",tipe_titik:l.tipe_titik||"Lainnya",id_jalur:l.id_jalur||"",koordinat:l.koordinat||"",deskripsi:l.deskripsi||"",ketersediaan_air:l.ketersediaan_air||!1,kapasitas_tenda:l.kapasitas_tenda||0})}catch(i){r.oR.error(i.message),a("/admin/poi")}finally{f(!1)}})()},[e,a]),(0,n.useEffect)(()=>{x(u?j.filter(a=>a.id_gunung===parseInt(u)):[])},[u,j]);const b=a=>{const{name:e,value:i,type:n,checked:s}=a.target;c(a=>(0,t.A)((0,t.A)({},a),{},{[e]:"checkbox"===n?s:i}))};return _?(0,l.jsx)("div",{className:"loading-container",children:"Memuat data..."}):(0,l.jsxs)("div",{className:"edit-poi-page",children:[(0,l.jsx)(r.N9,{position:"top-right",autoClose:3e3}),(0,l.jsxs)("header",{className:"page-header",children:[(0,l.jsxs)("h1",{children:["Edit POI: ",i.nama_titik]}),(0,l.jsxs)(s.N_,{to:"/admin/poi",className:"btn-back",children:[(0,l.jsx)("i",{className:"bi bi-arrow-left"})," Kembali"]})]}),(0,l.jsxs)("form",{onSubmit:async n=>{if(n.preventDefault(),!i.nama_titik||!i.id_jalur)return void r.oR.warn("Nama POI dan Jalur terkait wajib diisi.");f(!0);const s=(0,t.A)((0,t.A)({},i),{},{nama_titik:d(i.nama_titik)});try{const i=localStorage.getItem("token"),t=await fetch("".concat(o,"/api/admin/poi/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(i)},body:JSON.stringify(s)}),n=await t.json();if(!t.ok)throw new Error(n.message);r.oR.success(n.message),a("/admin/poi")}catch(l){r.oR.error(l.message||"Terjadi kesalahan saat memperbarui data.")}finally{f(!1)}},className:"form-widget-poi",children:[(0,l.jsxs)("fieldset",{className:"form-fieldset",disabled:_,children:[(0,l.jsx)("legend",{children:"Informasi Utama"}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"nama_titik",children:"Nama Titik Penting (POI)"}),(0,l.jsx)("input",{type:"text",id:"nama_titik",name:"nama_titik",value:i.nama_titik,onChange:b,onBlur:a=>{const{name:e,value:i}=a.target;"nama_titik"===e&&c(a=>(0,t.A)((0,t.A)({},a),{},{[e]:d(i)}))},required:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"tipe_titik",children:"Kategori Titik Penting"}),(0,l.jsxs)("select",{id:"tipe_titik",name:"tipe_titik",value:i.tipe_titik,onChange:b,children:[(0,l.jsx)("option",{value:"Pos",children:"Pos"}),(0,l.jsx)("option",{value:"Shelter",children:"Shelter"}),(0,l.jsx)("option",{value:"Sumber Air",children:"Sumber Air"}),(0,l.jsx)("option",{value:"Area Kemah",children:"Area Kemah"}),(0,l.jsx)("option",{value:"Puncak",children:"Puncak"}),(0,l.jsx)("option",{value:"Spot Foto",children:"Spot Foto"}),(0,l.jsx)("option",{value:"Persimpangan",children:"Persimpangan"}),(0,l.jsx)("option",{value:"Lainnya",children:"Lainnya"})]})]})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"id_gunung",children:"Terletak di Gunung"}),(0,l.jsxs)("select",{id:"id_gunung",name:"id_gunung",value:u,onChange:a=>{m(a.target.value),c(a=>(0,t.A)((0,t.A)({},a),{},{id_jalur:""}))},children:[(0,l.jsx)("option",{value:"",children:"-- Pilih Gunung untuk filter jalur --"}),h.map(a=>(0,l.jsx)("option",{value:a.id_gunung,children:a.nama_gunung},a.id_gunung))]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"id_jalur",children:"Berada di Jalur"}),(0,l.jsxs)("select",{id:"id_jalur",name:"id_jalur",value:i.id_jalur,onChange:b,required:!0,disabled:!u||0===k.length,children:[(0,l.jsx)("option",{value:"",children:"-- Pilih Jalur --"}),k.map(a=>(0,l.jsx)("option",{value:a.id_jalur,children:a.nama_jalur},a.id_jalur))]})]})]}),(0,l.jsxs)("div",{className:"form-group full-width",children:[(0,l.jsx)("label",{htmlFor:"koordinat",children:"Koordinat Lokasi (Latitude, Longitude)"}),(0,l.jsx)("input",{type:"text",id:"koordinat",name:"koordinat",value:i.koordinat,onChange:b})]})]}),(0,l.jsxs)("fieldset",{className:"form-fieldset",disabled:_,children:[(0,l.jsx)("legend",{children:"Atribut Tambahan"}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"kapasitas_tenda",children:"Kapasitas Tenda (jika Area Camp)"}),(0,l.jsx)("input",{type:"number",id:"kapasitas_tenda",name:"kapasitas_tenda",value:i.kapasitas_tenda,onChange:b})]}),(0,l.jsxs)("div",{className:"form-group toggle-group",children:[(0,l.jsx)("label",{children:"Ketersediaan Sumber Air"}),(0,l.jsxs)("div",{className:"toggle-switch-container",children:[(0,l.jsx)("span",{children:"Tidak"}),(0,l.jsxs)("label",{className:"toggle-switch",children:[(0,l.jsx)("input",{type:"checkbox",id:"ketersediaan_air",name:"ketersediaan_air",checked:!!i.ketersediaan_air,onChange:b}),(0,l.jsx)("span",{className:"slider round"})]}),(0,l.jsx)("span",{children:"Ya"})]})]})]}),(0,l.jsxs)("div",{className:"form-group full-width",children:[(0,l.jsx)("label",{htmlFor:"deskripsi",children:"Deskripsi atau Keterangan Tambahan"}),(0,l.jsx)("textarea",{id:"deskripsi",name:"deskripsi",rows:"4",value:i.deskripsi,onChange:b})]})]}),(0,l.jsxs)("div",{className:"form-actions",children:[(0,l.jsx)("button",{type:"button",className:"btn-cancel",onClick:()=>a("/admin/poi"),disabled:_,children:"Batal"}),(0,l.jsx)("button",{type:"submit",className:"btn-save",disabled:_,children:_?"Menyimpan...":"Simpan Perubahan"})]})]})]})}}}]);
//# sourceMappingURL=33.7d25d40f.chunk.js.map