"use strict";(self.webpackChunkspk_gunung=self.webpackChunkspk_gunung||[]).push([[514],{1996:(a,i,e)=>{e.r(i),e.d(i,{default:()=>m});var n=e(2555),t=e(5043),s=e(1283),o=e(7488),r=(e(2342),e(2562)),l=e(2917),c=e(579);const d="http://localhost:5000";const m=function(){const a=(0,s.Zp)(),{id_gunung:i}=(0,s.g)(),[e,m]=(0,t.useState)({nama_gunung:"",ketinggian_puncak_mdpl:"",lokasi_administratif:[],deskripsi_singkat:""}),[u,p]=(0,t.useState)(""),[g,h]=(0,t.useState)(""),[k,f]=(0,t.useState)(""),[x,b]=(0,t.useState)([]),[v,j]=(0,t.useState)([]),[_,y]=(0,t.useState)([]),[w,N]=(0,t.useState)(!1),[S,C]=(0,t.useState)(!1),[A,P]=(0,t.useState)(!1),[R,E]=(0,t.useState)(null),[T,F]=(0,t.useState)(null),[L,D]=(0,t.useState)(!0),[G,I]=(0,t.useState)("");(0,t.useEffect)(()=>{fetch("".concat(d,"/api/csrf-token"),{credentials:"include"}).then(a=>a.ok?a.json():Promise.reject()).then(a=>I(a.csrfToken)).catch(()=>{})},[]),(0,t.useEffect)(()=>{(async()=>{N(!0);try{const a=await l.A.getProvinces();y(a)}catch(a){console.error("Error fetching provinsi:",a),o.oR.error("Gagal memuat data provinsi.")}finally{N(!1)}})()},[]),(0,t.useEffect)(()=>{(async()=>{D(!0);try{const a=localStorage.getItem("token"),e=await fetch("".concat(d,"/api/admin/gunung/").concat(i),{headers:{Authorization:"Bearer ".concat(a)}});if(!e.ok){const a=await e.json();throw new Error(a.message||"Data gunung tidak ditemukan.")}const n=await e.json(),t=n.lokasi_administratif?l.A.parseStoredLocation(n.lokasi_administratif):[];m({nama_gunung:n.nama_gunung||"",ketinggian_puncak_mdpl:n.ketinggian_puncak_mdpl||"",lokasi_administratif:t.map(a=>"".concat(a.regency,", ").concat(a.province)),deskripsi_singkat:n.deskripsi_singkat||""}),n.url_thumbnail&&F("".concat(d).concat(n.url_thumbnail))}catch(a){o.oR.error(a.message)}finally{D(!1)}})()},[i]);const z=a=>{m(i=>(0,n.A)((0,n.A)({},i),{},{[a.target.name]:a.target.value}))},K=a=>a?a.toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "):"";return L&&!e.nama_gunung?(0,c.jsx)("div",{className:"loading-container",children:"Memuat data..."}):(0,c.jsxs)("div",{className:"edit-gunung-page",children:[(0,c.jsx)(o.N9,{position:"top-right",autoClose:3e3,hideProgressBar:!1}),(0,c.jsx)(r.A,{title:"Edit Data: ".concat(e.nama_gunung||"..."),backText:"Kembali",backLink:"/admin/gunung"}),(0,c.jsxs)("form",{onSubmit:async n=>{n.preventDefault(),D(!0);const t=new FormData,s=Array.isArray(e.lokasi_administratif)?e.lokasi_administratif.join("; "):e.lokasi_administratif;t.append("nama_gunung",K(e.nama_gunung)),t.append("lokasi_administratif",s),t.append("ketinggian_puncak_mdpl",e.ketinggian_puncak_mdpl),t.append("deskripsi_singkat",e.deskripsi_singkat),R&&t.append("url_thumbnail",R);try{const e=localStorage.getItem("token"),n=await fetch("".concat(d,"/api/admin/gunung/").concat(i),{method:"PUT",headers:{Authorization:"Bearer ".concat(e),"X-CSRF-Token":G},body:t,credentials:"include"}),s=await n.json();if(!n.ok)throw new Error(s.message);o.oR.success("Data gunung berhasil diperbarui!"),setTimeout(()=>a("/admin/gunung"),1500)}catch(r){o.oR.error(r.message)}finally{D(!1)}},className:"form-widget-gunung",children:[(0,c.jsxs)("fieldset",{className:"form-fieldset",disabled:L,children:[(0,c.jsx)("legend",{children:"Informasi Dasar Gunung"}),(0,c.jsx)("div",{className:"form-row",children:(0,c.jsxs)("div",{className:"form-group full-width",children:[(0,c.jsx)("label",{htmlFor:"url_thumbnail",children:"Ganti Foto Utama / Thumbnail (Opsional)"}),(0,c.jsx)("div",{className:"foto-upload-container",onClick:()=>document.getElementById("url_thumbnail").click(),children:T?(0,c.jsx)("img",{src:T,alt:"Preview",className:"foto-preview"}):(0,c.jsxs)("div",{className:"foto-placeholder",children:[(0,c.jsx)("i",{className:"bi bi-image-alt"}),(0,c.jsx)("p",{children:"Tidak Ada Foto"})]})}),(0,c.jsx)("input",{type:"file",id:"url_thumbnail",name:"url_thumbnail",onChange:a=>{const i=a.target.files[0];i&&(E(i),F(URL.createObjectURL(i)))},accept:"image/*",style:{display:"none"}})]})}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"nama_gunung",children:"Nama Gunung"}),(0,c.jsx)("input",{type:"text",id:"nama_gunung",name:"nama_gunung",value:e.nama_gunung,onChange:z,required:!0})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"ketinggian_puncak_mdpl",children:"Ketinggian (MDPL)"}),(0,c.jsx)("input",{type:"number",id:"ketinggian_puncak_mdpl",name:"ketinggian_puncak_mdpl",value:e.ketinggian_puncak_mdpl,onChange:z,required:!0})]})]}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)("label",{htmlFor:"provinsi",children:["Provinsi",(0,c.jsx)("small",{style:{display:"block",color:"#666",fontSize:"12px",marginTop:"4px"},children:"Pilih provinsi untuk menambah lokasi administratif"})]}),(0,c.jsxs)("select",{id:"provinsi",name:"provinsi",value:u,onChange:async a=>{const i=a.target.value;if(p(i),h(""),f(""),b([]),j([]),i){C(!0);try{const a=await l.A.getRegencies(parseInt(i));b(a)}catch(e){console.error("Error fetching kabupaten:",e),o.oR.error("Gagal memuat data kabupaten.")}finally{C(!1)}}},className:"form-select",disabled:w,children:[(0,c.jsx)("option",{value:"",children:w?"Memuat data provinsi...":"Pilih Provinsi"}),_.map(a=>(0,c.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)("label",{htmlFor:"kabupaten",children:["Kabupaten/Kota",(0,c.jsx)("small",{style:{display:"block",color:"#666",fontSize:"12px",marginTop:"4px"},children:"Pilih kabupaten setelah memilih provinsi"})]}),(0,c.jsxs)("select",{id:"kabupaten",name:"kabupaten",value:g,onChange:async a=>{const i=a.target.value;if(h(i),f(""),j([]),i){P(!0);try{const a=await l.A.getDistricts(parseInt(i));j(a)}catch(e){console.error("Error fetching kecamatan:",e),o.oR.error("Gagal memuat data kecamatan.")}finally{P(!1)}}},className:"form-select",disabled:!u||S,children:[(0,c.jsx)("option",{value:"",children:S?"Memuat data kabupaten...":u?"Pilih Kabupaten/Kota":"Pilih provinsi terlebih dahulu"}),x.map(a=>(0,c.jsx)("option",{value:a.id,children:a.name},a.id))]})]})]}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)("label",{htmlFor:"kecamatan",children:["Kecamatan (Opsional)",(0,c.jsx)("small",{style:{display:"block",color:"#666",fontSize:"12px",marginTop:"4px"},children:"Pilih kecamatan untuk detail lokasi yang lebih spesifik"})]}),(0,c.jsxs)("select",{id:"kecamatan",name:"kecamatan",value:k,onChange:a=>{const i=a.target.value;f(i)},className:"form-select",disabled:!g||A,children:[(0,c.jsx)("option",{value:"",children:A?"Memuat data kecamatan...":g?"Pilih Kecamatan (Opsional)":"Pilih kabupaten terlebih dahulu"}),v.map(a=>(0,c.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,c.jsx)("div",{className:"form-group",style:{display:"flex",alignItems:"flex-end"},children:(0,c.jsxs)("button",{type:"button",onClick:()=>{var a,i,t;if(!u||!g)return void o.oR.warn("Pilih provinsi dan kabupaten terlebih dahulu.");const s=(null===(a=_.find(a=>a.id===u))||void 0===a?void 0:a.name)||"",r=(null===(i=x.find(a=>a.id===parseInt(g)))||void 0===i?void 0:i.name)||"",l=k&&(null===(t=v.find(a=>a.id===parseInt(k)))||void 0===t?void 0:t.name)||"";let c="";if(c=l?"Kec. ".concat(l,", ").concat(r,", ").concat(s):"".concat(r,", ").concat(s),e.lokasi_administratif.includes(c))return void o.oR.warn("Lokasi administratif ini sudah ditambahkan.");const d=[...e.lokasi_administratif,c];m(a=>(0,n.A)((0,n.A)({},a),{},{lokasi_administratif:d})),p(""),h(""),f(""),b([]),j([])},className:"btn-add-location",disabled:!u||!g,style:{backgroundColor:"#0369a1",color:"white",border:"none",borderRadius:"6px",padding:"12px 20px",fontSize:"14px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"background-color 0.2s",marginTop:"24px",minHeight:"44px"},onMouseEnter:a=>{a.target.disabled||(a.target.style.backgroundColor="#0284c7")},onMouseLeave:a=>{a.target.disabled||(a.target.style.backgroundColor="#0369a1")},children:[(0,c.jsx)("i",{className:"bi bi-plus-circle"}),"Tambah Lokasi"]})})]}),(0,c.jsx)("div",{className:"form-row",children:(0,c.jsxs)("div",{className:"form-group full-width",children:[(0,c.jsxs)("label",{children:["Lokasi Administratif Terpilih",(0,c.jsx)("small",{style:{display:"block",color:"#666",fontSize:"12px",marginTop:"4px"},children:"Daftar lokasi administratif yang akan disimpan untuk gunung ini"})]}),(0,c.jsxs)("div",{className:"selected-locations",children:[e.lokasi_administratif&&0!==e.lokasi_administratif.length?(0,c.jsx)("div",{className:"location-tags",children:e.lokasi_administratif.map((a,i)=>(0,c.jsxs)("div",{className:"location-tag enhanced",children:[(0,c.jsxs)("div",{className:"location-info",children:[(0,c.jsx)("i",{className:"bi bi-geo-alt-fill",style:{color:"#0369a1",marginRight:"6px"}}),(0,c.jsx)("span",{className:"location-text",children:a})]}),(0,c.jsx)("button",{type:"button",onClick:()=>(a=>{const i=[...e.lokasi_administratif];i.splice(a,1),m(a=>(0,n.A)((0,n.A)({},a),{},{lokasi_administratif:i}))})(i),className:"remove-location",title:"Hapus lokasi ini",children:(0,c.jsx)("i",{className:"bi bi-x-lg"})})]},i))}):(0,c.jsxs)("div",{style:{color:"#999",fontStyle:"italic",margin:"12px 0",padding:"16px",backgroundColor:"#f8fafc",borderRadius:"6px",border:"1px dashed #cbd5e1",textAlign:"center"},children:[(0,c.jsx)("i",{className:"bi bi-geo-alt",style:{fontSize:"24px",marginBottom:"8px",display:"block"}}),"Belum ada lokasi administratif yang ditambahkan.",(0,c.jsx)("br",{}),"Gunakan dropdown di atas untuk menambah lokasi."]}),e.lokasi_administratif&&e.lokasi_administratif.length>0&&(0,c.jsxs)("div",{style:{marginTop:"12px",padding:"8px 12px",backgroundColor:"#ecfdf5",border:"1px solid #a7f3d0",borderRadius:"6px",fontSize:"12px",color:"#047857"},children:[(0,c.jsx)("i",{className:"bi bi-info-circle-fill",style:{marginRight:"6px"}}),"Total ",e.lokasi_administratif.length," lokasi administratif akan disimpan."]})]})]})}),(0,c.jsx)("div",{className:"form-row",children:(0,c.jsxs)("div",{className:"form-group full-width",children:[(0,c.jsx)("label",{htmlFor:"deskripsi_singkat",children:"Deskripsi Singkat"}),(0,c.jsx)("textarea",{id:"deskripsi_singkat",name:"deskripsi_singkat",rows:"4",value:e.deskripsi_singkat,onChange:z})]})})]}),(0,c.jsxs)("div",{className:"form-actions",children:[(0,c.jsx)("button",{type:"button",className:"btn-cancel",onClick:()=>a("/admin/gunung"),disabled:L,children:"Batal"}),(0,c.jsx)("button",{type:"submit",className:"btn-save",disabled:L,children:L?"Menyimpan...":"Simpan Perubahan"})]})]})]})}},2562:(a,i,e)=>{e.d(i,{A:()=>s});e(5043);var n=e(1283),t=e(579);const s=a=>{let{title:i,backText:e,backLink:s}=a;return(0,t.jsxs)("header",{className:"page-header",children:[(0,t.jsx)("h1",{children:i}),(0,t.jsxs)(n.N_,{to:s,className:"btn-back",children:[(0,t.jsx)("i",{className:"bi bi-arrow-left"})," ",e]})]})}},2917:(a,i,e)=>{e.d(i,{A:()=>r});const n="https://www.emsifa.com/api-wilayah-indonesia/api",t="/provinces.json",s="/regencies",o="/districts",r={async getProvinces(){try{const a=await fetch("".concat(n).concat(t));if(!a.ok)throw new Error("Gagal memuat data provinsi");return await a.json()}catch(a){throw console.error("Error fetching provinces:",a),a}},async getRegencies(a){try{const i=await fetch("".concat(n).concat(s,"/").concat(a,".json"));if(!i.ok)throw new Error("Gagal memuat kabupaten untuk provinsi ".concat(a));return await i.json()}catch(i){throw console.error("Error fetching regencies for province ".concat(a,":"),i),i}},async getDistricts(a){try{const i=await fetch("".concat(n).concat(o,"/").concat(a,".json"));if(!i.ok)throw new Error("Gagal memuat kecamatan untuk kabupaten ".concat(a));return await i.json()}catch(i){throw console.error("Error fetching districts for regency ".concat(a,":"),i),i}},async getRegenciesForMultipleProvinces(a){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{const e=a.map(async a=>{var e;const n=await this.getRegencies(a),t=(null===(e=i.find(i=>i.id===a))||void 0===e?void 0:e.name)||"";return n.map(i=>({id:i.id,name:i.name,province_id:a,province_name:t}))});return(await Promise.all(e)).flat()}catch(e){throw console.error("Error fetching regencies for multiple provinces:",e),e}},parseStoredLocation:a=>a?a.split("; ").map(a=>{const i=a.split(", ");return{regency:i[0],province:i[1]}}):[],formatLocationForStorage(a){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return a.map(a=>{const e=i.find(i=>i.id===a);return e?"".concat(e.name,", ").concat(e.province_name):""}).filter(Boolean)}}}}]);
//# sourceMappingURL=514.52ab8811.chunk.js.map