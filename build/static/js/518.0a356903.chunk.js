"use strict";(self.webpackChunkspk_gunung=self.webpackChunkspk_gunung||[]).push([[518],{7273:(e,a,i)=>{i.r(a),i.d(a,{default:()=>u});var s=i(2555),n=i(5043),l=i(1283),r=i(7488),t=(i(2342),i(579));const o="http://localhost:5000/api/admin";const u=function(){const e=(0,l.Zp)(),[a,i]=(0,n.useState)([]),[u,d]=(0,n.useState)({judul:"",deskripsi:"",id_gunung:"",file:null}),[c,g]=(0,n.useState)(!1),[m,h]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{try{const e=localStorage.getItem("token"),a=await fetch("".concat(o,"/gunung"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)throw new Error("Gagal memuat daftar gunung.");const s=await a.json();i(s)}catch(e){r.oR.error(e.message)}})()},[]);const p=e=>{const{name:a,value:i,files:n}=e.target;"file"===a&&n[0]?(d(e=>(0,s.A)((0,s.A)({},e),{},{file:n[0]})),h(URL.createObjectURL(n[0]))):d(e=>(0,s.A)((0,s.A)({},e),{},{[a]:i}))};return(0,t.jsxs)("div",{className:"tambah-galeri-container",children:[(0,t.jsx)(r.N9,{position:"top-right",autoClose:3e3,hideProgressBar:!1}),(0,t.jsxs)("header",{className:"page-header-tambah",children:[(0,t.jsx)("h1",{children:"Unggah Foto Baru"}),(0,t.jsxs)(l.N_,{to:"/admin/gallery",className:"btn-kembali",children:[(0,t.jsx)("i",{className:"bi bi-arrow-left"})," Kembali ke Galeri"]})]}),(0,t.jsx)("div",{className:"form-wrapper-card",children:(0,t.jsxs)("form",{onSubmit:async a=>{if(a.preventDefault(),!u.file||!u.judul)return void r.oR.warn("Judul dan File Gambar wajib diisi!");g(!0);const i=localStorage.getItem("token"),s=new FormData;s.append("judul",u.judul),s.append("deskripsi",u.deskripsi),u.id_gunung&&s.append("id_gunung",u.id_gunung),s.append("foto",u.file);try{const a=await fetch("".concat(o,"/gallery"),{method:"POST",headers:{Authorization:"Bearer ".concat(i)},body:s}),n=await a.json();if(!a.ok)throw new Error(n.message);r.oR.success(n.message),e("/admin/gallery")}catch(n){r.oR.error(n.message)}finally{g(!1)}},children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"judul",children:"Judul Foto*"}),(0,t.jsx)("input",{type:"text",id:"judul",name:"judul",value:u.judul,onChange:p,required:!0,placeholder:"Contoh: Senja di atas Gunung Prau"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"deskripsi",children:"Deskripsi (Opsional)"}),(0,t.jsx)("textarea",{id:"deskripsi",name:"deskripsi",value:u.deskripsi,onChange:p,rows:"4",placeholder:"Deskripsi singkat mengenai foto..."})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"id_gunung",children:"Tautkan ke Gunung (Opsional)"}),(0,t.jsxs)("select",{name:"id_gunung",id:"id_gunung",value:u.id_gunung,onChange:p,children:[(0,t.jsx)("option",{value:"",children:"-- Tidak Ditautkan --"}),a.map(e=>(0,t.jsx)("option",{value:e.id_gunung,children:e.nama_gunung},e.id_gunung))]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Pilih File Gambar*"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"file",className:"custom-file-upload",children:[(0,t.jsx)("i",{className:"bi bi-folder2-open"})," Pilih File"]}),(0,t.jsx)("span",{className:"file-name",children:u.file?u.file.name:"Tidak ada file yang dipilih"}),(0,t.jsx)("input",{type:"file",id:"file",name:"file",onChange:p,accept:"image/jpeg, image/png, image/webp",required:!0})]})]}),m&&(0,t.jsxs)("div",{className:"image-preview-container",children:[(0,t.jsx)("p",{children:"Preview:"}),(0,t.jsx)("img",{src:m,alt:"Preview",className:"image-preview"})]}),(0,t.jsx)("div",{className:"form-actions",children:(0,t.jsxs)("button",{type:"submit",className:"btn-submit-galeri",disabled:c,children:[(0,t.jsx)("i",{className:"bi bi-upload"})," ",c?"Mengunggah...":"Unggah Foto"]})})]})})]})}}}]);
//# sourceMappingURL=518.0a356903.chunk.js.map