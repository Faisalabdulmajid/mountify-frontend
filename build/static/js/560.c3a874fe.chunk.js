"use strict";(self.webpackChunkspk_gunung=self.webpackChunkspk_gunung||[]).push([[560],{6560:(e,a,s)=>{s.r(a),s.d(a,{default:()=>o});var n=s(2555),i=s(5043),r=s(1283),l=s(579);const t="http://localhost:5000";const o=function(){const e=(0,r.Zp)(),{id_user:a}=(0,r.g)(),[s,o]=(0,i.useState)({namaLengkap:"",username:"",email:"",domisili:"",instansi:"",nomorTelepon:"",peran:"user",status:"Aktif"}),[m,c]=(0,i.useState)(null),[d,u]=(0,i.useState)(""),[p,h]=(0,i.useState)(""),[g,j]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{j(!0),u("");try{const e=localStorage.getItem("token");if(!e)throw new Error("Akses ditolak. Token tidak ditemukan.");const s=await fetch("".concat(t,"/api/admin/users/").concat(a),{headers:{Authorization:"Bearer ".concat(e)}});if(!s.ok){const e=await s.json();throw new Error(e.message||"Pengguna tidak ditemukan.")}const n=await s.json();o({namaLengkap:n.nama_lengkap||"",username:n.username||"",email:n.email||"",domisili:n.domisili||"",instansi:n.instansi||"",nomorTelepon:n.nomor_telepon||"",peran:n.peran||"user",status:n.status||"Aktif"}),n.url_foto_profil&&c("".concat(t).concat(n.url_foto_profil))}catch(e){u(e.message)}finally{j(!1)}})()},[a]);const x=e=>{o(a=>(0,n.A)((0,n.A)({},a),{},{[e.target.name]:e.target.value}))};return g?(0,l.jsx)("div",{className:"loading-container",children:"Memuat data pengguna..."}):d&&!s.namaLengkap?(0,l.jsxs)("div",{className:"edit-user-page",children:[(0,l.jsx)("header",{className:"page-header",children:(0,l.jsx)("h1",{children:"Edit Pengguna"})}),(0,l.jsx)("p",{className:"form-error-message",children:d}),(0,l.jsxs)(r.N_,{to:"/admin/users",className:"btn-back",children:[(0,l.jsx)("i",{className:"bi bi-arrow-left"})," Kembali"]})]}):(0,l.jsxs)("div",{className:"edit-user-page",children:[(0,l.jsxs)("header",{className:"page-header",children:[(0,l.jsxs)("h1",{children:["Edit Pengguna: ",s.namaLengkap]}),(0,l.jsxs)(r.N_,{to:"/admin/users",className:"btn-back",children:[(0,l.jsx)("i",{className:"bi bi-arrow-left"})," Kembali"]})]}),d&&(0,l.jsx)("p",{className:"form-error-message",children:d}),p&&(0,l.jsx)("p",{className:"form-success-message",children:p}),(0,l.jsxs)("form",{onSubmit:async n=>{n.preventDefault(),u(""),h(""),j(!0);const i={nama_lengkap:s.namaLengkap,email:s.email,domisili:s.domisili,instansi:s.instansi,nomor_telepon:s.nomorTelepon,peran:s.peran,status:s.status},r=localStorage.getItem("token");try{const s=await(async()=>{try{const e=await fetch("".concat(t,"/api/csrf-token"),{credentials:"include"});if(!e.ok)throw new Error("Gagal mengambil CSRF token");return(await e.json()).csrfToken}catch(e){return null}})();if(!s)return u("Gagal mengambil CSRF token."),void j(!1);const n=await fetch("".concat(t,"/api/admin/users/").concat(a),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r),"X-CSRF-Token":s},body:JSON.stringify(i),credentials:"include"}),l=await n.json();if(!n.ok)throw new Error(l.message||"Gagal memperbarui profil.");h("Profil pengguna berhasil diperbarui!"),setTimeout(()=>e("/admin/users"),1500)}catch(l){u(l.message)}finally{j(!1)}},className:"form-widget-user",children:[(0,l.jsx)("div",{className:"form-row",children:(0,l.jsxs)("div",{className:"form-group full-width",children:[(0,l.jsx)("label",{children:"Foto Profil"}),(0,l.jsxs)("div",{className:"avatar-upload-container",children:[m?(0,l.jsx)("img",{src:m,alt:"Avatar Preview",className:"avatar-preview"}):(0,l.jsx)("div",{className:"avatar-placeholder",children:(0,l.jsx)("i",{className:"bi bi-person-fill"})}),(0,l.jsx)("small",{children:"Ganti avatar dapat dilakukan pengguna dari halaman profilnya."})]})]})}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"namaLengkap",children:"Nama Lengkap"}),(0,l.jsx)("input",{type:"text",id:"namaLengkap",name:"namaLengkap",value:s.namaLengkap,onChange:x,required:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"username",children:"Username (Tidak Dapat Diubah)"}),(0,l.jsx)("input",{type:"text",id:"username",name:"username",value:s.username,readOnly:!0,disabled:!0})]})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"email",children:"Alamat Email"}),(0,l.jsx)("input",{type:"email",id:"email",name:"email",value:s.email,onChange:x,required:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"nomorTelepon",children:"Nomor Telepon"}),(0,l.jsx)("input",{type:"tel",id:"nomorTelepon",name:"nomorTelepon",value:s.nomorTelepon,onChange:x})]})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"domisili",children:"Domisili"}),(0,l.jsx)("input",{type:"text",id:"domisili",name:"domisili",value:s.domisili,onChange:x})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"instansi",children:"Instansi"}),(0,l.jsx)("input",{type:"text",id:"instansi",name:"instansi",value:s.instansi,onChange:x})]})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"peran",children:"Level Peran"}),(0,l.jsxs)("select",{id:"peran",name:"peran",value:s.peran,onChange:x,children:[(0,l.jsx)("option",{value:"user",children:"User"}),(0,l.jsx)("option",{value:"admin",children:"Admin"}),(0,l.jsx)("option",{value:"superadmin",children:"Super Admin"})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"status",children:"Status"}),(0,l.jsxs)("select",{id:"status",name:"status",value:s.status,onChange:x,children:[(0,l.jsx)("option",{value:"Aktif",children:"Aktif"}),(0,l.jsx)("option",{value:"Nonaktif",children:"Nonaktif"}),(0,l.jsx)("option",{value:"Diblokir",children:"Diblokir"})]})]})]}),(0,l.jsxs)("div",{className:"form-actions",children:[(0,l.jsx)("button",{type:"button",className:"btn-cancel",onClick:()=>e("/admin/users"),disabled:g,children:"Batal"}),(0,l.jsx)("button",{type:"submit",className:"btn-save",disabled:g,children:g?"Menyimpan...":"Simpan Perubahan"})]})]})]})}}}]);
//# sourceMappingURL=560.c3a874fe.chunk.js.map