"use strict";(self.webpackChunkspk_gunung=self.webpackChunkspk_gunung||[]).push([[615],{2615:(a,e,s)=>{s.r(e),s.d(e,{default:()=>m});var n=s(2555),r=s(5043),i=s(1283),l=s(64),o=s.n(l),t=(s(6681),s(7488)),d=(s(2342),s(579));const m=function(){const a=(0,i.Zp)(),[e,s]=(0,r.useState)({namaLengkap:"",username:"",email:"",password:"",confirmPassword:"",domisili:"",instansi:"",nomorTelepon:"",peran:"user",status:"Aktif",avatar:null}),[l,m]=(0,r.useState)(null),[c,p]=(0,r.useState)(null),[u,h]=(0,r.useState)(!1),x=a=>{const{name:e,value:r}=a.target;s(a=>(0,n.A)((0,n.A)({},a),{},{[e]:r}))};return(0,d.jsxs)("div",{className:"add-user-page",children:[(0,d.jsxs)("header",{className:"page-header",children:[(0,d.jsx)("h1",{children:"Tambah Pengguna Baru"}),(0,d.jsxs)(i.N_,{to:"/admin/users",className:"btn-back",children:[(0,d.jsx)("i",{className:"bi bi-arrow-left"})," Kembali ke Daftar"]})]}),(0,d.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),p(null),e.password!==e.confirmPassword)return void t.oR.error("Password dan konfirmasi password tidak cocok!");h(!0);const n=new FormData;n.append("nama_lengkap",e.namaLengkap),n.append("username",e.username),n.append("email",e.email),n.append("password",e.password),n.append("domisili",e.domisili),n.append("instansi",e.instansi),n.append("nomor_telepon",e.nomorTelepon),n.append("peran",e.peran),n.append("status",e.status),e.avatar&&n.append("avatar",e.avatar);const r=localStorage.getItem("token");try{const e=await(async()=>{try{const a=await fetch("".concat("http://localhost:5000","/api/csrf-token"),{credentials:"include"});if(!a.ok)throw new Error("Gagal mengambil CSRF token");return(await a.json()).csrfToken}catch(a){return null}})();if(!e)return t.oR.error("Gagal mengambil CSRF token."),void h(!1);const s=await fetch("http://localhost:5000/api/admin/users",{method:"POST",headers:{Authorization:"Bearer ".concat(r),"X-CSRF-Token":e},body:n,credentials:"include"}),i=await s.json();if(!s.ok)throw new Error(i.message||"Gagal menambahkan pengguna.");await o().fire({icon:"success",title:"Berhasil!",text:"Pengguna baru berhasil ditambahkan!",timer:1800,showConfirmButton:!1}),a("/admin/users")}catch(i){t.oR.error(i.message)}finally{h(!1)}},className:"form-widget",children:[(0,d.jsx)("div",{className:"form-row",children:(0,d.jsxs)("div",{className:"form-group full-width",children:[(0,d.jsx)("label",{htmlFor:"avatar",children:"Foto Profil"}),(0,d.jsxs)("div",{className:"avatar-upload-container",children:[l?(0,d.jsx)("img",{src:l,alt:"Avatar Preview",className:"avatar-preview"}):(0,d.jsx)("div",{className:"avatar-placeholder",children:(0,d.jsx)("i",{className:"bi bi-person-fill"})}),(0,d.jsx)("input",{type:"file",id:"avatar",name:"avatar",onChange:a=>{const e=a.target.files[0];e&&(s(a=>(0,n.A)((0,n.A)({},a),{},{avatar:e})),m(URL.createObjectURL(e)))},accept:"image/*"})]})]})}),(0,d.jsxs)("div",{className:"form-row",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"namaLengkap",children:"Nama Lengkap"}),(0,d.jsx)("input",{type:"text",id:"namaLengkap",name:"namaLengkap",value:e.namaLengkap,onChange:x,required:!0})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"username",children:"Username"}),(0,d.jsx)("input",{type:"text",id:"username",name:"username",value:e.username,onChange:x,required:!0})]})]}),(0,d.jsxs)("div",{className:"form-row",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"email",children:"Alamat Email"}),(0,d.jsx)("input",{type:"email",id:"email",name:"email",value:e.email,onChange:x,required:!0})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"nomorTelepon",children:"Nomor Telepon"}),(0,d.jsx)("input",{type:"tel",id:"nomorTelepon",name:"nomorTelepon",value:e.nomorTelepon,onChange:x})]})]}),(0,d.jsxs)("div",{className:"form-row",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"domisili",children:"Domisili"}),(0,d.jsx)("input",{type:"text",id:"domisili",name:"domisili",value:e.domisili,onChange:x})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"instansi",children:"Instansi"}),(0,d.jsx)("input",{type:"text",id:"instansi",name:"instansi",value:e.instansi,onChange:x})]})]}),(0,d.jsxs)("div",{className:"form-row",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"password",children:"Kata Sandi"}),(0,d.jsx)("input",{type:"password",id:"password",name:"password",value:e.password,onChange:x,required:!0})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"confirmPassword",children:"Konfirmasi Kata Sandi"}),(0,d.jsx)("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:e.confirmPassword,onChange:x,required:!0})]})]}),(0,d.jsxs)("div",{className:"form-row",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"peran",children:"Level Peran"}),(0,d.jsxs)("select",{id:"peran",name:"peran",value:e.peran,onChange:x,children:[(0,d.jsx)("option",{value:"user",children:"User"}),(0,d.jsx)("option",{value:"admin",children:"Admin"}),(0,d.jsx)("option",{value:"superadmin",children:"Super Admin"})]})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"status",children:"Status"}),(0,d.jsxs)("select",{id:"status",name:"status",value:e.status,onChange:x,children:[(0,d.jsx)("option",{value:"Aktif",children:"Aktif"}),(0,d.jsx)("option",{value:"Tidak Aktif",children:"Tidak Aktif"}),(0,d.jsx)("option",{value:"Diblokir",children:"Diblokir"})]})]})]}),c&&(0,d.jsx)("p",{className:"form-error-message",children:c}),(0,d.jsxs)("div",{className:"form-actions",children:[(0,d.jsx)("button",{type:"button",className:"btn-cancel",onClick:()=>a("/admin/users"),disabled:u,children:"Batal"}),(0,d.jsx)("button",{type:"submit",className:"btn-save",disabled:u,children:u?"Menyimpan...":"Simpan Pengguna"})]})]}),(0,d.jsx)(t.N9,{position:"top-right",autoClose:3e3})]})}},6681:()=>{}}]);
//# sourceMappingURL=615.f52e427f.chunk.js.map