{"version":3,"file":"static/js/615.f52e427f.chunk.js","mappings":"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","sources":["pages/admin/pengguna/TambahPengguna.js"],"sourcesContent":["// TambahPengguna.js (Disesuaikan dengan Skema Database db_gunung2)\r\nimport React, { useState } from \"react\";\r\nimport { useNavigate, Link } from \"react-router-dom\";\r\nimport \"./TambahPengguna.css\";\r\nimport Swal from \"sweetalert2\";\r\nimport \"sweetalert2/dist/sweetalert2.min.css\";\r\nimport { ToastContainer, toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\n\r\nconst API_BASE_URL = \"http://localhost:5000\";\r\n\r\nfunction TambahPengguna() {\r\n  const navigate = useNavigate();\r\n  const [formData, setFormData] = useState({\r\n    namaLengkap: \"\",\r\n    username: \"\",\r\n    email: \"\",\r\n    password: \"\",\r\n    confirmPassword: \"\",\r\n    domisili: \"\",\r\n    instansi: \"\",\r\n    nomorTelepon: \"\",\r\n    peran: \"user\", // PERBAIKAN: Menggunakan 'peran'\r\n    status: \"Aktif\",\r\n    avatar: null,\r\n  });\r\n  const [avatarPreview, setAvatarPreview] = useState(null);\r\n  const [error, setError] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData((prevState) => ({ ...prevState, [name]: value }));\r\n  };\r\n\r\n  const handleAvatarChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      setFormData((prevState) => ({ ...prevState, avatar: file }));\r\n      setAvatarPreview(URL.createObjectURL(file));\r\n    }\r\n  };\r\n\r\n  // Ambil CSRF token dari endpoint\r\n  const fetchCSRFToken = async () => {\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/api/csrf-token`, {\r\n        credentials: \"include\",\r\n      });\r\n      if (!response.ok) throw new Error(\"Gagal mengambil CSRF token\");\r\n      const data = await response.json();\r\n      return data.csrfToken;\r\n    } catch (err) {\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n    if (formData.password !== formData.confirmPassword) {\r\n      toast.error(\"Password dan konfirmasi password tidak cocok!\");\r\n      return;\r\n    }\r\n    setIsLoading(true);\r\n\r\n    const dataToSend = new FormData();\r\n    dataToSend.append(\"nama_lengkap\", formData.namaLengkap);\r\n    dataToSend.append(\"username\", formData.username);\r\n    dataToSend.append(\"email\", formData.email);\r\n    dataToSend.append(\"password\", formData.password);\r\n    dataToSend.append(\"domisili\", formData.domisili);\r\n    dataToSend.append(\"instansi\", formData.instansi);\r\n    dataToSend.append(\"nomor_telepon\", formData.nomorTelepon);\r\n    dataToSend.append(\"peran\", formData.peran);\r\n    dataToSend.append(\"status\", formData.status);\r\n    if (formData.avatar) {\r\n      dataToSend.append(\"avatar\", formData.avatar);\r\n    }\r\n\r\n    const token = localStorage.getItem(\"token\");\r\n    try {\r\n      // Ambil CSRF token dari endpoint\r\n      const csrfToken = await fetchCSRFToken();\r\n      if (!csrfToken) {\r\n        toast.error(\"Gagal mengambil CSRF token.\");\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      const response = await fetch(\"http://localhost:5000/api/admin/users\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          \"X-CSRF-Token\": csrfToken,\r\n        },\r\n        body: dataToSend,\r\n        credentials: \"include\",\r\n      });\r\n      const result = await response.json();\r\n      if (!response.ok)\r\n        throw new Error(result.message || \"Gagal menambahkan pengguna.\");\r\n      await Swal.fire({\r\n        icon: \"success\",\r\n        title: \"Berhasil!\",\r\n        text: \"Pengguna baru berhasil ditambahkan!\",\r\n        timer: 1800,\r\n        showConfirmButton: false,\r\n      });\r\n      navigate(\"/admin/users\");\r\n    } catch (err) {\r\n      toast.error(err.message);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"add-user-page\">\r\n      <header className=\"page-header\">\r\n        <h1>Tambah Pengguna Baru</h1>\r\n        <Link to=\"/admin/users\" className=\"btn-back\">\r\n          <i className=\"bi bi-arrow-left\"></i> Kembali ke Daftar\r\n        </Link>\r\n      </header>\r\n\r\n      <form onSubmit={handleSubmit} className=\"form-widget\">\r\n        <div className=\"form-row\">\r\n          <div className=\"form-group full-width\">\r\n            <label htmlFor=\"avatar\">Foto Profil</label>\r\n            <div className=\"avatar-upload-container\">\r\n              {avatarPreview ? (\r\n                <img\r\n                  src={avatarPreview}\r\n                  alt=\"Avatar Preview\"\r\n                  className=\"avatar-preview\"\r\n                />\r\n              ) : (\r\n                <div className=\"avatar-placeholder\">\r\n                  <i className=\"bi bi-person-fill\"></i>\r\n                </div>\r\n              )}\r\n              <input\r\n                type=\"file\"\r\n                id=\"avatar\"\r\n                name=\"avatar\"\r\n                onChange={handleAvatarChange}\r\n                accept=\"image/*\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"form-row\">\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"namaLengkap\">Nama Lengkap</label>\r\n            <input\r\n              type=\"text\"\r\n              id=\"namaLengkap\"\r\n              name=\"namaLengkap\"\r\n              value={formData.namaLengkap}\r\n              onChange={handleChange}\r\n              required\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"username\">Username</label>\r\n            <input\r\n              type=\"text\"\r\n              id=\"username\"\r\n              name=\"username\"\r\n              value={formData.username}\r\n              onChange={handleChange}\r\n              required\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className=\"form-row\">\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"email\">Alamat Email</label>\r\n            <input\r\n              type=\"email\"\r\n              id=\"email\"\r\n              name=\"email\"\r\n              value={formData.email}\r\n              onChange={handleChange}\r\n              required\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"nomorTelepon\">Nomor Telepon</label>\r\n            <input\r\n              type=\"tel\"\r\n              id=\"nomorTelepon\"\r\n              name=\"nomorTelepon\"\r\n              value={formData.nomorTelepon}\r\n              onChange={handleChange}\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className=\"form-row\">\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"domisili\">Domisili</label>\r\n            <input\r\n              type=\"text\"\r\n              id=\"domisili\"\r\n              name=\"domisili\"\r\n              value={formData.domisili}\r\n              onChange={handleChange}\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"instansi\">Instansi</label>\r\n            <input\r\n              type=\"text\"\r\n              id=\"instansi\"\r\n              name=\"instansi\"\r\n              value={formData.instansi}\r\n              onChange={handleChange}\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className=\"form-row\">\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"password\">Kata Sandi</label>\r\n            <input\r\n              type=\"password\"\r\n              id=\"password\"\r\n              name=\"password\"\r\n              value={formData.password}\r\n              onChange={handleChange}\r\n              required\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"confirmPassword\">Konfirmasi Kata Sandi</label>\r\n            <input\r\n              type=\"password\"\r\n              id=\"confirmPassword\"\r\n              name=\"confirmPassword\"\r\n              value={formData.confirmPassword}\r\n              onChange={handleChange}\r\n              required\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className=\"form-row\">\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"peran\">Level Peran</label>\r\n            {/* PERBAIKAN: Menggunakan name='peran' dan value dari state.peran */}\r\n            <select\r\n              id=\"peran\"\r\n              name=\"peran\"\r\n              value={formData.peran}\r\n              onChange={handleChange}\r\n            >\r\n              <option value=\"user\">User</option>\r\n              <option value=\"admin\">Admin</option>\r\n              <option value=\"superadmin\">Super Admin</option>\r\n            </select>\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"status\">Status</label>\r\n            <select\r\n              id=\"status\"\r\n              name=\"status\"\r\n              value={formData.status}\r\n              onChange={handleChange}\r\n            >\r\n              <option value=\"Aktif\">Aktif</option>\r\n              <option value=\"Tidak Aktif\">Tidak Aktif</option>\r\n              <option value=\"Diblokir\">Diblokir</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n        {error && <p className=\"form-error-message\">{error}</p>}\r\n        <div className=\"form-actions\">\r\n          <button\r\n            type=\"button\"\r\n            className=\"btn-cancel\"\r\n            onClick={() => navigate(\"/admin/users\")}\r\n            disabled={isLoading}\r\n          >\r\n            Batal\r\n          </button>\r\n          <button type=\"submit\" className=\"btn-save\" disabled={isLoading}>\r\n            {isLoading ? \"Menyimpan...\" : \"Simpan Pengguna\"}\r\n          </button>\r\n        </div>\r\n      </form>\r\n      <ToastContainer position=\"top-right\" autoClose={3000} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default TambahPengguna;\r\n"],"names":["navigate","useNavigate","formData","setFormData","useState","namaLengkap","username","email","password","confirmPassword","domisili","instansi","nomorTelepon","peran","status","avatar","avatarPreview","setAvatarPreview","error","setError","isLoading","setIsLoading","handleChange","e","name","value","target","prevState","_objectSpread","_jsxs","className","children","_jsx","Link","to","onSubmit","async","preventDefault","toast","dataToSend","FormData","append","token","localStorage","getItem","csrfToken","response","fetch","concat","credentials","ok","Error","json","err","fetchCSRFToken","method","headers","Authorization","body","result","message","Swal","icon","title","text","timer","showConfirmButton","htmlFor","src","alt","type","id","onChange","file","files","URL","createObjectURL","accept","required","onClick","disabled","ToastContainer","position","autoClose"],"sourceRoot":""}