"use strict";(self.webpackChunkspk_gunung=self.webpackChunkspk_gunung||[]).push([[744],{744:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var i=a(2555),n=a(5043),s=a(1283),l=a(7488),r=(a(2342),a(3290)),o=(a(4949),a(579));const c="http://localhost:5000/api/admin";const u=function(){const e=(0,s.Zp)(),{id_artikel:t}=(0,s.g)(),[a,u]=(0,n.useState)({judul:"",kategori:"Tips & Trik",status:"Draft",konten:""}),[d,h]=(0,n.useState)(null),[m,k]=(0,n.useState)(null),[g,p]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{p(!0);try{const a=localStorage.getItem("token");if(!a)return l.oR.error("Anda harus login untuk mengedit artikel."),void e("/login");const i=await fetch("".concat(c,"/articles/").concat(t),{headers:{Authorization:"Bearer ".concat(a)}});if(!i.ok)throw new Error("Artikel tidak ditemukan atau gagal dimuat.");const n=await i.json();u({judul:n.judul,kategori:n.kategori,status:n.status,konten:n.isi_artikel}),k(n.url_gambar_utama)}catch(a){l.oR.error(a.message),e("/admin/articles")}finally{p(!1)}})()},[t,e]);const j=e=>{const{name:t,value:a}=e.target;u(e=>(0,i.A)((0,i.A)({},e),{},{[t]:a}))};return g?(0,o.jsx)("div",{className:"loading-container",children:"Memuat data artikel..."}):(0,o.jsxs)("div",{className:"add-edit-artikel-page",children:[(0,o.jsx)(l.N9,{position:"top-right",autoClose:3e3}),(0,o.jsxs)("header",{className:"page-header",children:[(0,o.jsx)("h1",{children:"Edit Artikel"}),(0,o.jsxs)(s.N_,{to:"/admin/articles",className:"btn-back",children:[(0,o.jsx)("i",{className:"bi bi-arrow-left"})," Kembali"]})]}),(0,o.jsxs)("form",{onSubmit:async i=>{if(i.preventDefault(),a.judul&&a.konten){p(!0);try{const i=localStorage.getItem("token");if(!i)return l.oR.error("Sesi Anda berakhir. Silakan login kembali."),void p(!1);const n=new FormData;n.append("judul",a.judul),n.append("kategori",a.kategori),n.append("status",a.status),n.append("isi_artikel",a.konten),d&&n.append("foto_utama",d);const s=await fetch("".concat(c,"/articles/").concat(t),{method:"PUT",headers:{Authorization:"Bearer ".concat(i)},body:n}),r=await s.json();if(!s.ok)throw new Error(r.message||"Gagal memperbarui artikel.");l.oR.success("Artikel berhasil diperbarui!"),setTimeout(()=>e("/admin/articles"),2e3)}catch(n){l.oR.error(n.message),p(!1)}}else l.oR.warn("Judul dan Konten artikel tidak boleh kosong.")},className:"form-widget-artikel",children:[(0,o.jsxs)("div",{className:"form-main-column",children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"judul",children:"Judul Artikel"}),(0,o.jsx)("input",{type:"text",id:"judul",name:"judul",value:a.judul,onChange:j,required:!0})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Konten Artikel"}),(0,o.jsx)(r.A,{content:a.konten,onContentChange:e=>{u(t=>(0,i.A)((0,i.A)({},t),{},{konten:e}))}})]})]}),(0,o.jsxs)("div",{className:"form-sidebar-column",children:[(0,o.jsxs)("div",{className:"widget-card-artikel-settings",children:[(0,o.jsx)("h3",{children:"Pengaturan Publikasi"}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"status",children:"Status"}),(0,o.jsxs)("select",{id:"status",name:"status",value:a.status,onChange:j,children:[(0,o.jsx)("option",{value:"Draft",children:"Simpan sebagai Draft"}),(0,o.jsx)("option",{value:"Published",children:"Publikasikan"})]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"kategori",children:"Kategori"}),(0,o.jsxs)("select",{id:"kategori",name:"kategori",value:a.kategori,onChange:j,children:[(0,o.jsx)("option",{value:"Tips & Trik",children:"Tips & Trik"}),(0,o.jsx)("option",{value:"Destinasi",children:"Destinasi"}),(0,o.jsx)("option",{value:"Review",children:"Review Peralatan"}),(0,o.jsx)("option",{value:"Edukasi",children:"Edukasi"}),(0,o.jsx)("option",{value:"Berita",children:"Berita Gunung"})]})]}),(0,o.jsx)("div",{className:"form-actions",children:(0,o.jsx)("button",{type:"submit",className:"btn-save-artikel",disabled:g,children:g?"Menyimpan...":"Perbarui Artikel"})})]}),(0,o.jsxs)("div",{className:"widget-card-artikel-settings",children:[(0,o.jsx)("h3",{children:"Foto Utama"}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("div",{className:"foto-upload-container-artikel",onClick:()=>document.getElementById("fotoUtama").click(),children:m?(0,o.jsx)("img",{src:m,alt:"Preview",className:"foto-preview-artikel"}):(0,o.jsxs)("div",{className:"foto-placeholder-artikel",children:[(0,o.jsx)("i",{className:"bi bi-image-fill"}),(0,o.jsx)("p",{children:"Klik untuk memilih foto"}),(0,o.jsx)("span",{children:"Rekomendasi 1200x800px"})]})}),(0,o.jsx)("input",{type:"file",id:"fotoUtama",name:"fotoUtama",onChange:e=>{const t=e.target.files[0];t&&t.type.startsWith("image/")?(h(t),k(URL.createObjectURL(t))):l.oR.warn("Silakan pilih file gambar.")},accept:"image/png, image/jpeg, image/webp",style:{display:"none"}})]})]})]})]})]})}},3290:(e,t,a)=>{a.d(t,{A:()=>k});var i=a(5043),n=a(4990),s=a(954),l=a(621),r=a(64),o=a.n(r),c=a(1981),u=a.n(c),d=a(579);const h=u()(o()),m=e=>{let{editor:t}=e;const a=(0,i.useCallback)(()=>{if(!t)return;const e=t.getAttributes("link").href;h.fire({title:"Masukkan URL",input:"url",inputLabel:"Alamat URL",inputValue:e,showCancelButton:!0,confirmButtonText:"Set Link",cancelButtonText:"Batal",confirmButtonColor:"#27ae60",inputValidator:e=>{if(!e)return"Anda perlu memasukkan URL!"}}).then(e=>{e.isConfirmed&&e.value&&t.chain().focus().extendMarkRange("link").setLink({href:e.value}).run()})},[t]);return t?(0,d.jsxs)("div",{className:"tiptap-menubar",children:[(0,d.jsx)("button",{type:"button",onClick:()=>t.chain().focus().toggleBold().run(),className:t.isActive("bold")?"is-active":"",children:"Bold"}),(0,d.jsx)("button",{type:"button",onClick:()=>t.chain().focus().toggleItalic().run(),className:t.isActive("italic")?"is-active":"",children:"Italic"}),(0,d.jsx)("button",{type:"button",onClick:()=>t.chain().focus().toggleStrike().run(),className:t.isActive("strike")?"is-active":"",children:"Strike"}),(0,d.jsx)("button",{type:"button",onClick:a,className:t.isActive("link")?"is-active":"",children:"Set Link"}),(0,d.jsx)("button",{type:"button",onClick:()=>t.chain().focus().unsetLink().run(),disabled:!t.isActive("link"),children:"Unset Link"}),(0,d.jsx)("button",{type:"button",onClick:()=>t.chain().focus().setParagraph().run(),className:t.isActive("paragraph")?"is-active":"",children:"Paragraph"}),(0,d.jsx)("button",{type:"button",onClick:()=>t.chain().focus().toggleHeading({level:1}).run(),className:t.isActive("heading",{level:1})?"is-active":"",children:"H1"}),(0,d.jsx)("button",{type:"button",onClick:()=>t.chain().focus().toggleHeading({level:2}).run(),className:t.isActive("heading",{level:2})?"is-active":"",children:"H2"}),(0,d.jsx)("button",{type:"button",onClick:()=>t.chain().focus().toggleBulletList().run(),className:t.isActive("bulletList")?"is-active":"",children:"Bullet List"}),(0,d.jsx)("button",{type:"button",onClick:()=>t.chain().focus().toggleOrderedList().run(),className:t.isActive("orderedList")?"is-active":"",children:"Ordered List"})]}):null},k=e=>{let{content:t,onContentChange:a}=e;const r=(0,n.hG)({extensions:[s.A,l.Ay.configure({autolink:!0,openOnClick:!1,linkOnPaste:!0})],content:t,onUpdate:e=>{let{editor:t}=e;a(t.getHTML())},editorProps:{attributes:{class:"tiptap-prose"}}});return(0,i.useEffect)(()=>{r&&t!==r.getHTML()&&r.commands.setContent(t,!1)},[t,r]),(0,d.jsxs)("div",{className:"tiptap-container",children:[(0,d.jsx)(m,{editor:r}),(0,d.jsx)(n.$Z,{editor:r})]})}},4949:()=>{}}]);
//# sourceMappingURL=744.42ba37aa.chunk.js.map